#!/bin/bash

# List of Pokemon to fetch
pokemon_list=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Directory to store output files
output_dir="pokemon_data"
mkdir -p "$output_dir"

# Error log file
error_log="errors.txt"


# Loop through each Pokemon
for pokemon in "${pokemon_list[@]}"; do
    echo "Fetching data for ${pokemon}..."

    # API URL
    url="https://pokeapi.co/api/v2/pokemon/${pokemon}"

    # File to save the data
    output_file="${output_dir}/${pokemon}.json"

    # Retry mechanism (max attempts)
    attempts=0
    success=false

    while [ $attempts -lt 3 ]; do
        curl -s "$url" -o "$output_file"

        # Check if curl succeeded (exit code 0)
        if [ $? -eq 0 ] && [ -s "$output_file" ]; then
            echo "Saved data to ${output_file} "
            success=true
            break
        else
            echo "Attempt $((attempts+1)) failed for ${pokemon}..."
            attempts=$((attempts+1))
            sleep 1
        fi
    done

    # If all attempts failed
    if [ "$success" = false ]; then
        echo "Failed to fetch ${pokemon} after 3 attempts." >> "$error_log"
        echo "Skipping ${pokemon} ‚ùå"
    fi

    # Rate-limiting delay
    sleep 1
done

